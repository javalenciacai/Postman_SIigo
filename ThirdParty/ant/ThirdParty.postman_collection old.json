
{"info":{"_postman_id":"16af3ff3-4104-4fd3-b04c-15272790e5d0","name":"TerceroJames","schema":"https:\/\/schema.getpostman.com\/json\/collection\/v2.0.0\/collection.json"},"item":[{"name":"auth","event":[{"listen":"test","script":{"type":"text\/javascript","exec":["bodyRequest = JSON.parse(responseBody)","","var token_value = bodyRequest.access_token;","pm.environment.set(\"token\", token_value);"]}},{"listen":"prerequest","script":{"type":"text\/javascript","exec":["pm.environment.set(\"urlToken\", \"http:\/\/23.101.145.208:50000\")\r","pm.environment.set(\"password\", \"1111\")\r","pm.environment.set(\"username\", \"empresaApi@estados.com\")\r",""]}}],"_postman_id":"d077cc4c-7b86-414e-86be-11861ea581bb","request":{"method":"POST","header":[{"key":"Authorization","value":"Basic U2lpZ29XZWI6QUJBMDhCNkEtQjU2Qy00MEE1LTkwQ0YtN0MxRTU0ODkxQjYx","type":"text"}],"body":{"mode":"urlencoded","urlencoded":[{"key":"grant_type","value":"password","type":"text"},{"key":"password","value":"{{password}}","type":"text"},{"key":"scope","value":"WebApi offline_access","type":"text"},{"key":"username","value":"{{username}}","type":"text"}]},"url":"{{urlToken}}\/connect\/token"},"response":[]},{"name":"Create","event":[{"listen":"test","script":{"type":"text\/javascript","exec":["\/\/Estado de c\u00f3digo\r","testStatus = pm.collectionVariables.get(\"status\");\r","\/\/Respuesta del request\r","responseBodys = JSON.parse(responseBody);\r","\/\/Respuesta del archivo\r","csvResponseBody = pm.collectionVariables.get(\"jsonResponse\");\r","\/\/VAriable para obtener guid\r","try {\r","    pm.collectionVariables.set(\"ThirdGuid\", responseBodys.AccountDto.Guid);\r","}\r","catch (e) { }\r","\/\/Variables para indicar el nivel dentro del json\r","arrayLevel0 = pm.collectionVariables.get(\"arrayLevel0\");\r","arrayLevel1 = pm.collectionVariables.get(\"arrayLevel1\");\r","arrayLevel2 = pm.collectionVariables.get(\"arrayLevel2\");\r","\r","objCsvResponse = [csvResponseBody[arrayLevel0],\r","csvResponseBody[arrayLevel0][arrayLevel1],\r","csvResponseBody[arrayLevel0][arrayLevel1][arrayLevel2]]\r","\r","objResponse = [responseBodys[arrayLevel0],\r","responseBodys[arrayLevel0][arrayLevel1],\r","responseBodys['AccountDto']['BasicData']['Phone']]\r","\/\/Array de propiedades\r","dataArray = pm.collectionVariables.get(\"dataArray\");\r","\/\/Variable que indica a que nivel del json se ingresa\r","jsonLevel = pm.collectionVariables.get(\"jsonLevel\");\r","\/\/Variable para indicar \r","index = pm.collectionVariables.get(\"index\");\r","\r","\r","\/\/contador\r","csvRespondeLength = 0;\r","\r","function propiertyCount() {\r","    for (prop in objCsvResponse[jsonLevel]) {\r","        var csvRespondeLength = csvRespondeLength + 1;\r","    }\r","    return csvRespondeLength;\r","}\r","\r","function selectFunctByIndex() {\r","    if (index) {\r","        return validateDataByIndex()\r","    } else {\r","        return validateData()\r","    }\r","}\r","\r","function validateData() {\r","    do {\r","        var i = 0;\r","        \r","\r","        for (propierty in dataArray) {\r","            \/\/variables para recorrer la respuesta del request y la respuesta del csv\r","            var responBody = objResponse[jsonLevel][dataArray[propierty]];            \r","            var responCsvBody = objCsvResponse[jsonLevel][dataArray[propierty]];\r","            console.log(\"responBody dentro del for-in: \" + responBody);\r","            if (responBody != responCsvBody) {\r","                report = (\"Valor no coincide: \" + dataArray[propierty] + \" Valor response: \" + responBody + \" valor csv: \" + responCsvBody);\r","                pm.collectionVariables.set(\"report\", false);\r","                return report;\r","            }\r","            else {\r","                pm.collectionVariables.set(\"report\", true);\r","            }\r","        }\r","        i++;\r","        console.log(\"propiertyCount() \" + propiertyCount());\r","    } while (i < propiertyCount())\r","    return (\"Pas\u00f3!\");\r","}\r","\r","function validateDataByIndex() {\r","    do {\r","        var i = 0;\r","        for (propierty in dataArray) {\r","            \/\/variables para recorrer la respuesta del request y la respuesta del csv\r","            var responBody = objResponse[jsonLevel][i][dataArray[propierty]];            \r","            var responCsvBody = objCsvResponse[jsonLevel][i][dataArray[propierty]];\r","            console.log(\"responBody  dentro del for-in: \" + responBody);\r","            console.log(\"responBody  dentro del for-in: \" +  pm.response.json().AccountDto.BasicData.Phone[0]['number']);\r","            if (responBody != responCsvBody) {\r","                report = (\"Valor no coincide: \" + dataArray[propierty] + \" Valor response: \" + responBody + \" valor csv: \" + responCsvBody);\r","                pm.collectionVariables.set(\"report\", false);\r","                return report;\r","            }\r","            else {\r","                pm.collectionVariables.set(\"report\", true);\r","            }\r","        }\r","        i++;\r","        console.log(\"propiertyCount() \" + propiertyCount());\r","    } while (i < propiertyCount())\r","    return (\"Pas\u00f3!\");\r","}\r","\r","pm.test(\"Status code is \" + testStatus, function () {\r","    pm.response.to.have.status(testStatus);\r","});\r","\r","pm.test(\"Basic data \" + selectFunctByIndex(), function () {\r","    pm.expect(pm.collectionVariables.get(\"report\")).to.eql(true);\r","});\r","\r",""]}},{"listen":"prerequest","script":{"type":"text\/javascript","exec":["\/\/url del api\r","pm.collectionVariables.set(\"urlApi\",\"https:\/\/qak8s.siigo.com\")\r","pm.collectionVariables.set(\"status\", 201);\r","pm.collectionVariables.set(\"jsonLevel\", 2);\r","pm.collectionVariables.set(\"index\", true);\r","pm.collectionVariables.set(\"arrayLevel0\", \"AccountDto\");\r","pm.collectionVariables.set(\"arrayLevel1\", \"BasicData\");\r","pm.collectionVariables.set(\"arrayLevel2\", \"Phone\");\r","pm.collectionVariables.set(\"dataArray\",['number']);\r","testjson = pm.collectionVariables.get(\"jsonBody\");\r","\/\/local data\r","testjson = {\"AccountDto\":{\"IsActive\":true,\"BasicData\":{\"IsCustomer\":true,\"IsSupplier\":false,\"IsOther\":false,\"IsSocialReason\":true,\"FirstName\":\"\",\"LastName\":\"\",\"FullName\":\"Andres Ruiz\",\"IdTypeCode\":21,\"Identification\":\"8656\",\"CheckDigit\":null,\"BranchOffice\":0,\"VATCompanyType\":0,\"CompanyName\":null,\"Address\":\"Cra 48 N\u00b0 26 - 85 Av. Industriales; Medell\u00edn; Antioquia\",\"City\":6791,\"Phone\":[{\"indicative\":\"1\",\"number\":\"11111\",\"extension\":\"1\"}]},\"Contacts\":[{\"FirstName\":\"Contacto\",\"LastName\":\"Prueba Asus\",\"Email\":\"contacto@siigo.com\",\"IsPrincipal\":true,\"ContactId\":null,\"AccountCode\":null,\"Charge\":\"Nuevo Cargo\",\"CellPhone\":{\"indicative\":\"444\",\"number\":\"4444444444\",\"extention\":\"4\"}}],\"RelatedUsers\":{\"SalesmanId\":null,\"CollectorId\":null},\"CreatedByDate\":\"2019-08-01T15:09:51.023Z\",\"CreatedByUser\":34156,\"UpdatedByDate\":\"0001-01-01T00:00:00Z\",\"UpdatedByUser\":null,\"Comments\":null,\"FiscalResponsibilityCode\":\"[{\\\"FiscalResponsibilityID\\\":22,\\\"Code\\\":\\\"O-99\\\",\\\"Description\\\":\\\"Otro tipo de obligado\\\"}]\",\"FreeFields\":[]}}\r","\r","testjson = JSON.stringify(testjson);\r","pm.collectionVariables.set(\"jsonBody\", testjson);\r","\r","\/\/testJsonResponse = pm.collectionVariables.get(\"jsonResponse\");\r","\/\/Recibe la respuesta del archivo\r","testJsonResponse = {\"AccountDto\":{\"Id\":\"5f0f15c59c3e850001333883\",\"Guid\":\"a9b56b10-9490-4262-8d29-42e707ab0bdf\",\"TenantId\":\"0x00000000000000000000000000154602\",\"AccountId\":565395,\"IsActive\":false,\"BasicData\":{\"IsCustomer\":true,\"IsSupplier\":false,\"IsOther\":false,\"IsSocialReason\":true,\"FirstName\":\"\",\"LastName\":\"\",\"FullName\":\"Andres Ruiz\",\"IdTypeCode\":21,\"Identification\":\"8618\",\"CheckDigit\":null,\"BranchOffice\":0,\"VATCompanyType\":0,\"CompanyName\":null,\"Address\":\"Cra 48 N\u00b0 26 - 85 Av. Industriales; Medell\u00edn; Antioquia\",\"City\":6791,\"Phone\":[{\"Indicative\":\"1\",\"Number\":\"11112\",\"Extention\":\"\"}]},\"Contacts\":[{\"FirstName\":\"Contactos\",\"LastName\":\"Prueba Asus\",\"Email\":\"contacto@siigo.com\",\"IsPrincipal\":true,\"ContactId\":265591,\"AccountCode\":565395,\"Charge\":\"Nuevo Cargo\",\"CellPhone\":{\"Indicative\":\"444\",\"Number\":\"4444444444\",\"Extention\":\"4\"}}],\"RelatedUsers\":{\"SalesmanId\":null,\"CollectorId\":null},\"Code\":\"ISY586RNST83WMW9EJWG\",\"CreatedByDate\":\"2020-07-15T14:42:12.7310052+00:00\",\"CreatedByUser\":7235,\"UpdatedByDate\":\"0001-01-01T00:00:00\",\"UpdatedByUser\":null,\"Comments\":null,\"Picture\":null,\"FiscalResponsibilityCode\":\"[{\\\"FiscalResponsibilityID\\\":22,\\\"Code\\\":\\\"O-99\\\",\\\"Description\\\":\\\"Otro tipo de obligado\\\"}]\",\"FreeFields\":[]}}\r","\r","\/*testJsonResponse = {\"Status\":409,\"Service\":\"msthirdparty\",\"Errors\":[{\"Code\":\"0002010099\",\"Message\":\"Conflict Business Validation\",\"Source\":\"Siigo.MsThirdParty.Application\",\"Params\":[],\"Detail\":\"Validation failed: \\n -- Identification & BranchOffice: La identificaci\u00f3n y la sucursal ya existena.\"}]}*\/\r","\/\/Se asigna a la var de colecci\u00f3n\r","\/\/testJsonResponse = JSON.stringify(testJsonResponse);\r","pm.collectionVariables.set(\"jsonResponse\", testJsonResponse);\r","\r","\r",""]}}],"_postman_id":"199015aa-314e-4bce-ad93-c880cb244c0f","request":{"method":"POST","header":[{"key":"Authorization","type":"text","value":"{{token}}"}],"body":{"mode":"raw","raw":"{{jsonBody}}","options":{"raw":{"language":"json"}}},"url":"{{urlApi}}\/api\/third-party\/account"},"response":[]},{"name":"Delete","_postman_id":"99379075-0334-43bb-8bc4-b38e7825469a","request":{"method":"DELETE","header":[{"key":"Authorization","type":"text","value":"{{token}}"}],"body":{"mode":"raw","raw":"","options":{"raw":{"language":"json"}}},"url":"{{urlApi}}\/api\/third-party\/account\/{{ThirdGuid}}"},"response":[]}],"event":[{"listen":"prerequest","script":{"id":"59f9779d-4656-4456-a783-e0f722fed451","type":"text\/javascript","exec":[""]}},{"listen":"test","script":{"id":"44178ed7-1eca-4ba5-b2fc-4574dc188c5f","type":"text\/javascript","exec":[""]}}],"variable":[{"id":"f5bacc2e-7441-48e3-af9c-1e4d615d33b9","key":"json","value":"{\"AccountDto\":{\"IsActive\":true,\"BasicData\":{\"IsCustomer\":true,\"IsSupplier\":false,\"IsOther\":false,\"IsSocialReason\":true,\"FirstName\":\"a\",\"LastName\":\"b\",\"FullName\":\"Andres Ruiz\",\"IdTypeCode\":21,\"Identification\":\"89031938\",\"CheckDigit\":null,\"BranchOffice\":0,\"VATCompanyType\":0,\"CompanyName\":null,\"Address\":\"Cra 48 N\u00b0 26 - 85 Av. Industriales; Medell\u00edn; Antioquia\",\"City\":6791,\"Phone\":[{\"indicative\":\"1\",\"number\":\"11111\",\"extension\":\"1\"}]},\"Contacts\":[{\"FirstName\":\"Contacto\",\"LastName\":\"Prueba Asus\",\"Email\":\"contacto@siigo.com\",\"IsPrincipal\":true,\"ContactId\":null,\"AccountCode\":null,\"Charge\":\"Nuevo Cargo\",\"CellPhone\":{\"indicative\":\"444\",\"number\":\"4444444444\",\"extention\":\"4\"}}],\"RelatedUsers\":{\"SalesmanId\":null,\"CollectorId\":null},\"CreatedByDate\":\"2019-08-01T15:09:51.023Z\",\"CreatedByUser\":34156,\"UpdatedByDate\":\"0001-01-01T00:00:00Z\",\"UpdatedByUser\":null,\"Comments\":null,\"FiscalResponsibilityCode\":\"[{\\\"FiscalResponsibilityID\\\":22,\\\"Code\\\":\\\"O-99\\\",\\\"Description\\\":\\\"Otro tipo de obligado\\\"}]\",\"FreeFields\":[]}}","type":"string"},{"id":"8d0ef524-ce51-48d0-81cf-db621d08b1a9","key":"status","value":201,"type":"number"},{"id":"55323bb8-8c89-41a9-8213-d77b6335bdbf","key":"urlApi","value":"https:\/\/qak8s.siigo.com","type":"string"},{"id":"bae7002b-309b-4c33-9621-7cef5e549233","key":"guid","value":"ceb7dc80-ac60-424f-8287-4c8332167d82","type":"string"},{"id":"f81b9577-0838-47e6-8125-0540a64e07e2","key":"jsonBody","value":"{\"AccountDto\":{\"IsActive\":true,\"BasicData\":{\"IsCustomer\":true,\"IsSupplier\":false,\"IsOther\":false,\"IsSocialReason\":true,\"FirstName\":\"\",\"LastName\":\"\",\"FullName\":\"Andres Ruiz\",\"IdTypeCode\":21,\"Identification\":\"8655\",\"CheckDigit\":null,\"BranchOffice\":0,\"VATCompanyType\":0,\"CompanyName\":null,\"Address\":\"Cra 48 N\u00b0 26 - 85 Av. Industriales; Medell\u00edn; Antioquia\",\"City\":6791,\"Phone\":[{\"indicative\":\"1\",\"number\":\"11111\",\"extension\":\"1\"}]},\"Contacts\":[{\"FirstName\":\"Contacto\",\"LastName\":\"Prueba Asus\",\"Email\":\"contacto@siigo.com\",\"IsPrincipal\":true,\"ContactId\":null,\"AccountCode\":null,\"Charge\":\"Nuevo Cargo\",\"CellPhone\":{\"indicative\":\"444\",\"number\":\"4444444444\",\"extention\":\"4\"}}],\"RelatedUsers\":{\"SalesmanId\":null,\"CollectorId\":null},\"CreatedByDate\":\"2019-08-01T15:09:51.023Z\",\"CreatedByUser\":34156,\"UpdatedByDate\":\"0001-01-01T00:00:00Z\",\"UpdatedByUser\":null,\"Comments\":null,\"FiscalResponsibilityCode\":\"[{\\\"FiscalResponsibilityID\\\":22,\\\"Code\\\":\\\"O-99\\\",\\\"Description\\\":\\\"Otro tipo de obligado\\\"}]\",\"FreeFields\":[]}}","type":"string"},{"id":"935a73bf-e272-48cf-a942-83bdf8306735","key":"jsonResponse","value":{"AccountDto":{"AccountId":565395,"BasicData":{"Address":"Cra 48 N\u00b0 26 - 85 Av. Industriales; Medell\u00edn; Antioquia","BranchOffice":0,"CheckDigit":null,"City":6791,"CompanyName":null,"FirstName":"","FullName":"Andres Ruiz","IdTypeCode":21,"Identification":"8618","IsCustomer":true,"IsOther":false,"IsSocialReason":true,"IsSupplier":false,"LastName":"","Phone":[{"Extention":"","Indicative":"1","Number":"11112"}],"VATCompanyType":0},"Code":"ISY586RNST83WMW9EJWG","Comments":null,"Contacts":[{"AccountCode":565395,"CellPhone":{"Extention":"4","Indicative":"444","Number":"4444444444"},"Charge":"Nuevo Cargo","ContactId":265591,"Email":"contacto@siigo.com","FirstName":"Contactos","IsPrincipal":true,"LastName":"Prueba Asus"}],"CreatedByDate":"2020-07-15T14:42:12.7310052+00:00","CreatedByUser":7235,"FiscalResponsibilityCode":"[{\"FiscalResponsibilityID\":22,\"Code\":\"O-99\",\"Description\":\"Otro tipo de obligado\"}]","FreeFields":[],"Guid":"a9b56b10-9490-4262-8d29-42e707ab0bdf","Id":"5f0f15c59c3e850001333883","IsActive":false,"Picture":null,"RelatedUsers":{"CollectorId":null,"SalesmanId":null},"TenantId":"0x00000000000000000000000000154602","UpdatedByDate":"0001-01-01T00:00:00","UpdatedByUser":null}},"type":"any"},{"id":"1e9354b7-156d-4528-a158-c5bd1ed016a9","key":"report","value":true,"type":"boolean"},{"id":"cc22f2d3-c593-4172-bd2b-bb42f4e6b9de","key":"arrayResponse","value":"AccountDto","type":"string"},{"id":"7c840a2d-6228-466c-94a6-8d90b3348e31","key":"subArray","value":true,"type":"boolean"},{"id":"8b737e85-62bf-4b77-a83b-97bed68707c8","key":"dataArray","value":["number"],"type":"any"},{"id":"e63fd44a-37a6-4eb5-bbb1-f247442c2837","key":"ThirdGuid","value":"54bb855d-2f45-43cf-aace-1434d4de6b01","type":"string"},{"id":"0f530bc8-65d3-44e4-9b92-d783a01d990a","key":"jsonLevel","value":2,"type":"number"},{"id":"7434e3b8-d937-4e5e-b008-141553a5a367","key":"arrayLevel1","value":"BasicData","type":"string"},{"id":"509e0171-d87b-4a17-abf4-55fa4abf8fc6","key":"arrayLevel2","value":"Phone","type":"string"},{"id":"a619bd13-bdc8-4f39-8dda-1fd3665370e9","key":"arrayLevel3","value":"Phone","type":"string"},{"id":"b904d28a-44b0-413b-a05e-22bd2a869d5b","key":"arrayLevel0","value":"AccountDto","type":"string"},{"id":"640edfcf-81b3-474a-ad17-abcd847d285a","key":"index","value":true,"type":"boolean"}],"protocolProfileBehavior":{}}